FROM docker.io/debian:bookworm-slim@sha256:67f3931ad8cb1967beec602d8c0506af1e37e8d73c2a0b38b181ec5d8560d395
ARG VERSION=7.2.5 # renovate: datasource=github-releases depName=redis/redis

RUN apt-get update -y && apt-get install -y --no-install-recommends ca-certificates
ADD --chown=_apt https://packages.redis.io/gpg /etc/apt/trusted.gpg.d/redis.asc

RUN echo "deb https://packages.redis.io/deb bookworm main" > /etc/apt/sources.list.d/redis.list && \
    apt-get update && apt-get install -y --no-install-recommends redis-server="6:${VERSION}*"

COPY container/config /etc/redis
USER redis

EXPOSE 6379
ENTRYPOINT ["redis-server", "/etc/redis/redis.conf"]
