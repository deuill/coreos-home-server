FROM docker.io/debian:bookworm-slim@sha256:7802002798b0e351323ed2357ae6dc5a8c4d0a05a57e7f4d8f97136151d3d603
ARG VERSION=7.2.4 # renovate: datasource=github-releases depName=redis/redis

RUN apt-get update -y && apt-get install -y --no-install-recommends ca-certificates
ADD --chown=_apt https://packages.redis.io/gpg /etc/apt/trusted.gpg.d/redis.asc

RUN echo "deb https://packages.redis.io/deb bookworm main" > /etc/apt/sources.list.d/redis.list && \
    apt-get update && apt-get install -y --no-install-recommends redis-server="6:${VERSION}*"

COPY container/config /etc/redis
USER redis

EXPOSE 6379
ENTRYPOINT ["redis-server", "/etc/redis/redis.conf"]
